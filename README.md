# Ù…Ø­ÙˆÙ‘Ù„ PDF Ø¹Ø±Ø¨ÙŠ Ø°ÙƒÙŠ Ø¥Ù„Ù‰ Ù…Ø§Ø±ÙƒØ¯Ø§ÙˆÙ†

Ù‡Ø°Ø§ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ù‡Ùˆ Ø®Ø· Ø£Ù†Ø§Ø¨ÙŠØ¨ Ù…ØªÙ‚Ø¯Ù… Ù„ØªØ­ÙˆÙŠÙ„ Ù…Ù„ÙØ§Øª PDF Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø¥Ù„Ù‰ Ù…Ù„ÙØ§Øª Markdown (MD) Ù…Ù†Ø¸Ù…Ø©. ÙŠØ³ØªØ®Ø¯Ù… Ø§Ù„Ø³ÙƒØ±ÙŠØ¨Øª Ù†Ù…Ø§Ø°Ø¬ Ù„ØºÙˆÙŠØ© ÙƒØ¨ÙŠØ±Ø© (LLM) Ù…ØªØ¹Ø¯Ø¯Ø© Ø§Ù„ÙˆØ³Ø§Ø¦Ø· Ù„ØªØ­Ù„ÙŠÙ„ ØµÙˆØ± ØµÙØ­Ø§Øª PDFØŒ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†ØµÙˆØµØŒ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ØµÙˆØ± Ø§Ù„Ù‡Ø§Ù…Ø©ØŒ ÙˆØ¥Ù†Ø´Ø§Ø¡ Ù…Ø­ØªÙˆÙ‰ Ù†ØµÙŠ ÙˆØµÙÙŠ Ù„Ù‡Ø§ØŒ Ù…Ø¹ Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø¨Ù†ÙŠØ© Ù…Ù†Ø·Ù‚ÙŠØ© Ù„Ù„Ù…Ø­ØªÙˆÙ‰.

---

<div dir="rtl">

## ğŸ“œ Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©

Ø§Ù„Ù‡Ø¯Ù Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ù‡Ùˆ Ø£ØªÙ…ØªØ© Ø¹Ù…Ù„ÙŠØ© ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ø§Ù„Ù…Ø·Ø¨ÙˆØ¹Ø© (PDF) Ø¥Ù„Ù‰ ØµÙŠØºØ© Ø±Ù‚Ù…ÙŠØ© Ù…Ø±Ù†Ø© ÙˆÙ‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªØ­Ø±ÙŠØ± (Markdown). Ù‡Ø°Ø§ ÙŠØ³Ù‡Ù„ Ø£Ø±Ø´ÙØ© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ØŒ Ø§Ù„Ø¨Ø­Ø« ÙÙŠÙ‡ØŒ ÙˆØ¥Ø¹Ø§Ø¯Ø© Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ ÙÙŠ Ù…Ù†ØµØ§Øª Ø§Ù„ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ. Ø§Ù„Ø³ÙƒØ±ÙŠØ¨Øª Ù…ØµÙ…Ù… Ø®ØµÙŠØµØ§Ù‹ Ù„Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ ØªØ­Ø¯ÙŠØ§Øª Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¹Ø±Ø¨ÙŠØŒ Ù…Ø«Ù„ Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ù†Øµ ÙˆØ§Ù„ØµÙˆØ± Ø§Ù„Ù…ØªØ¯Ø§Ø®Ù„Ø©.

## âœ¨ Ø§Ù„Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©

- **Ù…Ø¹Ø§Ù„Ø¬Ø© ØµÙˆØ± Ø§Ù„ØµÙØ­Ø§Øª**: ÙŠÙ‚ÙˆÙ… Ø¨ØªÙ†Ù‚ÙŠØ© ÙƒÙ„ ØµÙØ­Ø© (Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù…ÙŠÙ„Ø§Ù†ØŒ ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„ØªØ´ÙˆÙŠØ´ØŒ ØªØ­Ø³ÙŠÙ† Ø§Ù„ØªØ¨Ø§ÙŠÙ†) Ù„Ø²ÙŠØ§Ø¯Ø© Ø¯Ù‚Ø© Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ù†ØµÙˆØµ (OCR).
- **Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø°ÙƒÙŠ Ù„Ù„ØµÙˆØ±**: ÙŠÙ…ÙŠØ² Ø¨ÙŠÙ† Ø§Ù„ØµÙˆØ± Ø§Ù„ØªÙˆØ¶ÙŠØ­ÙŠØ© Ø§Ù„Ù‡Ø§Ù…Ø© (Ù…Ø«Ù„ Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ© ÙˆØ§Ù„Ø®Ø±Ø§Ø¦Ø·) ÙˆØ§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø²Ø®Ø±ÙÙŠØ© (Ù…Ø«Ù„ Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª ÙˆØ§Ù„Ø¥Ø·Ø§Ø±Ø§Øª)ØŒ ÙˆÙŠØªØ¬Ø§Ù‡Ù„ Ø§Ù„Ø£Ø®ÙŠØ±Ø©.
- **ØªØ­Ù„ÙŠÙ„ Ø¨ÙˆØ§Ø³Ø·Ø© Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ**: ÙŠØ±Ø³Ù„ ØµÙˆØ±Ø© Ø§Ù„ØµÙØ­Ø© ÙˆØ§Ù„ØµÙˆØ± Ø§Ù„Ù…Ø³ØªØ®Ø±Ø¬Ø© Ø¥Ù„Ù‰ Ù†Ù…ÙˆØ°Ø¬ `Gemini 2.5 Pro` Ù„ØªØ­Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„.
- **ØªÙˆÙ„ÙŠØ¯ Ù…Ø­ØªÙˆÙ‰ ÙˆØµÙÙŠ**: ÙŠÙ‚ÙˆÙ… Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ù„ØºÙˆÙŠ Ø¨ØªÙˆÙ„ÙŠØ¯ Ø£ÙˆØµØ§Ù Ø¹Ø±Ø¨ÙŠØ© Ù„Ù„ØµÙˆØ± Ø§Ù„Ù‡Ø§Ù…Ø© ÙˆÙŠØ¯Ù…Ø¬Ù‡Ø§ ÙÙŠ Ù…Ù„Ù Ø§Ù„Ù…Ø§Ø±ÙƒØ¯Ø§ÙˆÙ†.
- **Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙˆØµÙÙŠØ©**: ÙŠØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ø³Ù… Ø§Ù„ÙˆØ­Ø¯Ø©ØŒ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¯Ø±Ø³ØŒ ÙˆØ±Ù‚Ù… Ø§Ù„Ø¯Ø±Ø³ Ù…Ù† Ø§Ù„ØµÙØ­Ø©.
- **Ù‡ÙŠÙƒÙ„ Ù…Ø®Ø±Ø¬Ø§Øª Ù…Ù†Ø¸Ù…**: ÙŠÙ†Ø´Ø¦ Ù…Ø¬Ù„Ø¯Ø§Ù‹ Ø®Ø§ØµØ§Ù‹ Ù„ÙƒÙ„ Ù…Ù„Ù PDF Ù…Ø¹ Ù…Ø¬Ù„Ø¯Ø§Øª ÙØ±Ø¹ÙŠØ© Ù„Ù„Ù…Ø­ØªÙˆÙ‰ ÙˆØ§Ù„ØµÙˆØ±ØŒ Ù…Ù…Ø§ ÙŠØ¶Ù…Ù† ØªÙ†Ø¸ÙŠÙ… Ø§Ù„Ù…Ø´Ø±ÙˆØ¹.
- **ÙˆØ§Ø¬Ù‡Ø© Ø³Ø·Ø± Ø§Ù„Ø£ÙˆØ§Ù…Ø± (CLI)**: ÙŠÙˆÙØ± ÙˆØ§Ø¬Ù‡Ø© Ù…Ø±Ù†Ø© Ù„Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©ØŒ Ù…Ø«Ù„ ØªØ­Ø¯ÙŠØ¯ Ù…Ø¬Ù„Ø¯Ø§Øª Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª ÙˆØ§Ù„Ù…Ø®Ø±Ø¬Ø§Øª.

## âš™ï¸ Ø¢Ù„ÙŠØ© Ø§Ù„Ø¹Ù…Ù„

ÙŠØ¹Ù…Ù„ Ø§Ù„Ø³ÙƒØ±ÙŠØ¨Øª Ø¹Ø¨Ø± Ø³Ù„Ø³Ù„Ø© Ù…Ù† Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„Ù…Ù†Ø¸Ù…Ø© Ù„ÙƒÙ„ ØµÙØ­Ø© ÙÙŠ Ù…Ù„Ù PDF:

1.  **ØªØ­ÙˆÙŠÙ„ PDF Ø¥Ù„Ù‰ ØµÙˆØ±**: ÙŠØªÙ… ØªØ­ÙˆÙŠÙ„ ÙƒÙ„ ØµÙØ­Ø© Ù…Ù† Ù…Ù„Ù PDF Ø¥Ù„Ù‰ ØµÙˆØ±Ø© Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø¯Ù‚Ø© (PNG).
2.  **Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©**: ØªØ®Ø¶Ø¹ ØµÙˆØ±Ø© Ø§Ù„ØµÙØ­Ø© Ù„Ø¹Ù…Ù„ÙŠØ§Øª ØªØ­Ø³ÙŠÙ† Ù„Ø¶Ù…Ø§Ù† Ø£Ù‚ØµÙ‰ ÙˆØ¶ÙˆØ­ Ù„Ù„Ù†Øµ.
3.  **Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„ØµÙˆØ± Ø§Ù„ÙØ±Ø¹ÙŠØ©**: ÙŠØªÙ… Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙˆØ± Ø§Ù„Ù…Ø¶Ù…Ù†Ø© Ù…Ù† Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… PyMuPDF.
4.  **Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø¹Ø¨Ø± LLM**: ØªÙØ±Ø³Ù„ ØµÙˆØ±Ø© Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…ÙØ­Ø³ÙÙ‘Ù†Ø© ÙˆØ§Ù„ØµÙˆØ± Ø§Ù„ÙØ±Ø¹ÙŠØ© Ø§Ù„Ù…Ø³ØªØ®Ø±Ø¬Ø© Ø¥Ù„Ù‰ Gemini API.
5.  **ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ù…Ø§Ø±ÙƒØ¯Ø§ÙˆÙ†**: ÙŠÙ‚ÙˆÙ… Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¨ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ØŒ ÙƒØªØ§Ø¨Ø© Ø§Ù„Ù†ØµØŒ ØªÙ‚ÙŠÙŠÙ… Ø§Ù„ØµÙˆØ±ØŒ ÙƒØªØ§Ø¨Ø© Ø£ÙˆØµØ§Ù Ù„Ù„ØµÙˆØ± Ø§Ù„Ù‡Ø§Ù…Ø©ØŒ ÙˆØªÙ†Ø³ÙŠÙ‚ ÙƒÙ„ Ø°Ù„Ùƒ ÙÙŠ ÙƒØ§Ø¦Ù† JSON.
6.  **Ø­ÙØ¸ ÙˆØªÙ†Ø¸ÙŠÙ**: ÙŠØªÙ… Ø­ÙØ¸ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø§Ø±ÙƒØ¯Ø§ÙˆÙ† ÙÙŠ Ù…Ù„Ù `.md`ØŒ ÙˆÙŠØªÙ… Ø­Ø°Ù Ø§Ù„ØµÙˆØ± Ø§Ù„ØªÙŠ Ø§Ø¹ØªØ¨Ø±Ù‡Ø§ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø²Ø®Ø±ÙÙŠØ© Ø£Ùˆ ØºÙŠØ± Ø¶Ø±ÙˆØ±ÙŠØ© Ù„Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ù†Ø¸Ø§ÙØ© Ø§Ù„Ù…Ø®Ø±Ø¬Ø§Øª.

## ğŸš€ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ ÙˆØ§Ù„ØªØ´ØºÙŠÙ„

Ø§ØªØ¨Ø¹ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·ÙˆØ§Øª Ù„Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ ÙˆØªØ´ØºÙŠÙ„Ù‡ Ø¹Ù„Ù‰ Ø¬Ù‡Ø§Ø²Ùƒ.

### 1. Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©

- **Python 3.8+**
- **Ù…ÙØªØ§Ø­ API**: ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ù…ÙØªØ§Ø­ API Ù…Ù† [OpenRouter.ai](https://openrouter.ai/) Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù†Ù…ÙˆØ°Ø¬ Gemini.
- **Poppler**: Ù‡Ø°Ù‡ Ù…ÙƒØªØ¨Ø© Ø®Ø§Ø±Ø¬ÙŠØ© Ø¶Ø±ÙˆØ±ÙŠØ© Ù„Ø¹Ù…Ù„ `pdf2image`.

    - **Ø¹Ù„Ù‰ Windows**:
        1.  Ø­Ù…Ù‘Ù„ Ø£Ø­Ø¯Ø« Ù†Ø³Ø®Ø© Ù…Ù† [Poppler for Windows](https://github.com/oschwartz10612/poppler-windows/releases/).
        2.  ÙÙƒ Ø¶ØºØ· Ø§Ù„Ù…Ù„Ù ÙˆØ£Ø¶Ù Ù…Ø³Ø§Ø± Ù…Ø¬Ù„Ø¯ `bin` Ø¥Ù„Ù‰ Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¨ÙŠØ¦Ø© `Path`.

    - **Ø¹Ù„Ù‰ macOS** (Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Homebrew):
        ```bash
        brew install poppler
        ```
    - **Ø¹Ù„Ù‰ Linux** (Debian/Ubuntu):
        ```bash
        sudo apt-get update && sudo apt-get install poppler-utils
        ```

### 2. Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªØ«Ø¨ÙŠØª

1.  **Ø§Ø³ØªÙ†Ø³Ø® Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹ (Clone the repository):**
    ```bash
    git clone [your-repository-url]
    cd [repository-folder]
    ```

2.  **Ø«Ø¨Ù‘Øª Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:**
    ```bash
    pip install -r requirements.txt
    ```

3.  **Ù‚Ù… Ø¨Ø¥Ø¹Ø¯Ø§Ø¯ Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¨ÙŠØ¦Ø©:**
    -   Ø£Ù†Ø´Ø¦ Ù…Ù„ÙØ§Ù‹ Ø¬Ø¯ÙŠØ¯Ø§Ù‹ Ø¨Ø§Ø³Ù… `.env` ÙÙŠ Ø§Ù„Ù…Ø¬Ù„Ø¯ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ù„Ù…Ø´Ø±ÙˆØ¹.
    -   Ø£Ø¶Ù Ù…ÙØªØ§Ø­ API Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ù„Ù Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø´ÙƒÙ„:
        ```
        OPENROUTER_API_KEY="sk-or-..."
        ```

### 3. Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…

1.  Ø¶Ø¹ Ø¬Ù…ÙŠØ¹ Ù…Ù„ÙØ§Øª PDF Ø§Ù„ØªÙŠ ØªØ±ÙŠØ¯ Ù…Ø¹Ø§Ù„Ø¬ØªÙ‡Ø§ Ø¯Ø§Ø®Ù„ Ù…Ø¬Ù„Ø¯ `pdfs`. Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹ØŒ Ù‚Ù… Ø¨Ø¥Ù†Ø´Ø§Ø¦Ù‡.
2.  Ù‚Ù… Ø¨ØªØ´ØºÙŠÙ„ Ø§Ù„Ø³ÙƒØ±ÙŠØ¨Øª Ù…Ù† Ø³Ø·Ø± Ø§Ù„Ø£ÙˆØ§Ù…Ø±.

    **Ø£Ø¨Ø³Ø· Ø£Ù…Ø± Ù„Ù„ØªØ´ØºÙŠÙ„:**
    ```bash
    python ocr_smart_arabic_v9.py
    ```

    **Ø£Ù…Ø± Ù…Ø¹ Ø®ÙŠØ§Ø±Ø§Øª Ù…Ø®ØµØµØ©:**
    ```bash
    python ocr_smart_arabic_v9.py --pdf-dir "my_books" --output-dir "results" --dpi 300 --save-processed-scans
    ```

### 4. Ø®ÙŠØ§Ø±Ø§Øª Ø³Ø·Ø± Ø§Ù„Ø£ÙˆØ§Ù…Ø±

-   `--pdf-dir`: Ø§Ù„Ù…Ø¬Ù„Ø¯ Ø§Ù„Ø°ÙŠ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù…Ù„ÙØ§Øª PDF (Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ: `pdfs`).
-   `--output-dir`: Ø§Ù„Ù…Ø¬Ù„Ø¯ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ø­ÙØ¸ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø®Ø±Ø¬Ø§Øª (Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ: `output`).
-   `--dpi`: Ø§Ù„Ø¯Ù‚Ø© (DPI) Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø© Ù„ØªØ­ÙˆÙŠÙ„ PDF Ø¥Ù„Ù‰ ØµÙˆØ± (Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ: `300`).
-   `--api-key`: Ù„ØªÙ…Ø±ÙŠØ± Ù…ÙØªØ§Ø­ API Ù…Ø¨Ø§Ø´Ø±Ø© (ÙŠØªØ¬Ø§ÙˆØ² Ù…ØªØºÙŠØ± Ø§Ù„Ø¨ÙŠØ¦Ø©).
-   `--clear-output`: Ù„Ø­Ø°Ù Ù…Ø¬Ù„Ø¯ Ø§Ù„Ù…Ø®Ø±Ø¬Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù‚Ø¨Ù„ Ø§Ù„Ø¨Ø¯Ø¡ Ù…Ù† Ø¬Ø¯ÙŠØ¯.
-   `--save-processed-scans`: Ù„Ø­ÙØ¸ ØµÙˆØ± Ø§Ù„ØµÙØ­Ø§Øª Ø¨Ø¹Ø¯ Ù…Ø¹Ø§Ù„Ø¬ØªÙ‡Ø§ (Ù„Ø£ØºØ±Ø§Ø¶ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© ÙˆØ§Ù„ØªØµØ­ÙŠØ­).

## ğŸ“ Ù‡ÙŠÙƒÙ„ Ø§Ù„Ù…Ø®Ø±Ø¬Ø§Øª

Ù„ÙƒÙ„ Ù…Ù„Ù PDF ØªØªÙ… Ù…Ø¹Ø§Ù„Ø¬ØªÙ‡ØŒ Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù‡ÙŠÙƒÙ„ Ø§Ù„ØªØ§Ù„ÙŠ Ø¯Ø§Ø®Ù„ Ù…Ø¬Ù„Ø¯ `output`:

```
output/
â””â”€â”€ Ø§Ø³Ù…_Ù…Ù„Ù_PDF/
    â”œâ”€â”€ illustrative_images/
    â”‚   â”œâ”€â”€ page_1/
    â”‚   â”‚   â””â”€â”€ img_0.png
    â”‚   â””â”€â”€ page_2/
    â”‚       â”œâ”€â”€ img_0.png
    â”‚       â””â”€â”€ img_1.png
    â”œâ”€â”€ markdown_content/
    â”‚   â””â”€â”€ Unit_Ø§Ù„ÙˆØ­Ø¯Ø©_Ø§Ù„Ø£ÙˆÙ„Ù‰_Lesson_Ø§Ù„Ø¯Ø±Ø³_Ø§Ù„Ø£ÙˆÙ„_Ø¹Ù†ÙˆØ§Ù†_Ø§Ù„Ø¯Ø±Ø³.md
    â””â”€â”€ processed_page_scans/  (Ø¥Ø°Ø§ ØªÙ… ØªÙØ¹ÙŠÙ„Ù‡)
        â”œâ”€â”€ scan_page_1.png
        â””â”€â”€ scan_page_2.png
```

## ğŸ“„ Ø§Ù„ØªØ±Ø®ÙŠØµ

Ù‡Ø°Ø§ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ù…Ø±Ø®Øµ ØªØ­Øª Ø±Ø®ØµØ© MIT.

</div>

---

# Smart Arabic PDF to Markdown Converter

This project is an advanced pipeline for converting Arabic educational PDF files into structured Markdown (MD) files. The script utilizes a multimodal Large Language Model (LLM) to analyze PDF page images, extract text, identify important images, and generate descriptive content for them, all while maintaining a logical content structure.

---

<div dir="ltr">

## ğŸ“œ Overview

The primary goal of this project is to automate the conversion of printed educational materials (PDF) into a flexible and editable digital format (Markdown). This facilitates content archiving, searching, and reuse in e-learning platforms. The script is specifically designed to handle the challenges of Arabic content, such as right-to-left text direction and nested images.

## âœ¨ Key Features

- **Page Image Pre-processing**: Cleans each page (deskew, denoise, enhance contrast) to improve Optical Character Recognition (OCR) accuracy.
- **Intelligent Image Extraction**: Differentiates between important illustrative images (like diagrams and maps) and decorative elements (like icons and borders), ignoring the latter.
- **AI-Powered Analysis**: Sends the page image and extracted sub-images to the `Gemini 2.5 Pro` model for a comprehensive analysis.
- **Descriptive Content Generation**: The LLM generates Arabic descriptions for important images and integrates them into the Markdown file.
- **Metadata Extraction**: Identifies the unit name, lesson title, and lesson number from the page.
- **Organized Output Structure**: Creates a dedicated folder for each PDF with clear subdirectories for content and images, ensuring a tidy project.
- **Command-Line Interface (CLI)**: Provides a flexible interface to control the processing, such as specifying input and output directories.

## âš™ï¸ How It Works

The script operates through a structured pipeline for each page in the PDF file:

1.  **PDF to Image Conversion**: Each PDF page is converted into a high-resolution image (PNG).
2.  **Main Image Pre-processing**: The page image undergoes enhancement operations to ensure maximum text clarity.
3.  **Sub-Image Extraction**: All embedded images are extracted from the original page using PyMuPDF.
4.  **LLM Analysis**: The processed page image and the extracted sub-images are sent to the Gemini API.
5.  **Markdown Generation**: The model analyzes the content, transcribes the text, evaluates the images, writes captions for the important ones, and formats everything into a JSON object.
6.  **Saving and Cleanup**: The Markdown content is saved to a `.md` file, and images deemed decorative or unnecessary by the model are deleted to keep the output clean.

## ğŸš€ Setup and Usage

Follow these steps to set up and run the project on your machine.

### 1. Prerequisites

- **Python 3.8+**
- **API Key**: You will need an API key from [OpenRouter.ai](https://openrouter.ai/) to access the Gemini model.
- **Poppler**: This is an external dependency required by `pdf2image`.

    - **On Windows**:
        1.  Download the latest release from [Poppler for Windows](https://github.com/oschwartz10612/poppler-windows/releases/).
        2.  Unzip the file and add the path to the `bin` folder to your system's `Path` environment variable.

    - **On macOS** (using Homebrew):
        ```bash
        brew install poppler
        ```
    - **On Linux** (Debian/Ubuntu):
        ```bash
        sudo apt-get update && sudo apt-get install poppler-utils
        ```

### 2. Installation Steps

1.  **Clone the repository:**
    ```bash
    git clone [your-repository-url]
    cd [repository-folder]
    ```

2.  **Install the required libraries:**
    ```bash
    pip install -r requirements.txt
    ```

3.  **Set up environment variables:**
    -   Create a new file named `.env` in the project's root directory.
    -   Add your API key to the file in this format:
        ```
        OPENROUTER_API_KEY="sk-or-..."
        ```

### 3. How to Use

1.  Place all the PDF files you want to process inside the `pdfs` directory. If it doesn't exist, create it.
2.  Run the script from your command line.

    **Simplest command to run:**
    ```bash
    python ocr_smart_arabic_v9.py
    ```

    **Command with custom options:**
    ```bash
    python ocr_smart_arabic_v9.py --pdf-dir "my_books" --output-dir "results" --dpi 300 --save-processed-scans
    ```

### 4. Command-Line Arguments

-   `--pdf-dir`: The directory containing the PDF files (Default: `pdfs`).
-   `--output-dir`: The main directory to save all outputs (Default: `output`).
-   `--dpi`: The resolution (DPI) to use for converting PDF to images (Default: `300`).
-   `--api-key`: Pass the API key directly (overrides the environment variable).
-   `--clear-output`: Delete the main output directory before starting.
-   `--save-processed-scans`: Enable saving the processed (B&W) page images for review.

## ğŸ“ Output Structure

For each processed PDF, the following structure will be created inside the `output` directory:

```
output/
â””â”€â”€ PDF_FILENAME/
    â”œâ”€â”€ illustrative_images/
    â”‚   â”œâ”€â”€ page_1/
    â”‚   â”‚   â””â”€â”€ img_0.png
    â”‚   â””â”€â”€ page_2/
    â”‚       â”œâ”€â”€ img_0.png
    â”‚       â””â”€â”€ img_1.png
    â”œâ”€â”€ markdown_content/
    â”‚   â””â”€â”€ Unit_UnitOne_Lesson_LessonOne_LessonTitle.md
    â””â”€â”€ processed_page_scans/  (if enabled)
        â”œâ”€â”€ scan_page_1.png
        â””â”€â”€ scan_page_2.png
```

## ğŸ“„ License

This project is licensed under the MIT License.

</div>